<!DOCTYPE html>
<html lang='en'>
<head>
    <meta charset='UTF-8'>
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src {{cspSource}}; script-src {{cspSource}}; img-src {{cspSource}};">
    <link rel="stylesheet" type="text/css" href="{{testSectionCssUri}}" />
    
     <!-- Matches list styles -->
    <link rel="stylesheet" type="text/css" href="{{matchesCssUri}}" />

    <title>Semgrep Rule Tester</title>
  
</head>
<body>
  {{htmlheader}}
  <div class="container">
    <!-- Start Semgrep Scan -->
    <div class="form-group">

      <!-- Config Path -->
      <label for="configPath">
        Config(s) to include
        <span class="info-tooltip">
          <span class="info-icon" tabindex="0" aria-label="Help">&#x1F6C8;</span>
            <span class="tooltip" id="configPathTooltip">
              Choose one ore more Semgrep configurations to control which rules are run.
              Comma seperate them, or set a path to the rules!<br>
              You can also use the semgrep playgound to further create/test your Rules.
              <a href="https://semgrep.dev/playground/" target="_blank">https://semgrep.dev/playground/</a>.
            </span>
          </span>
          <span class="label-colon">:</span>
        </span>
      </label>
      <div class="input-wrapper">
        <button type="button" id="configPathWizard" class="folder-btn">Select File/Folder</button>
        <input type="text" id="configPath" value="auto">
      </div>


      <!-- Exclude Pattern -->
      <label for="excludePattern">Exclude pattern(s) (optional):</label>
      <div class="input-wrapper">
        <input type="text" id="excludePattern" placeholder="e.g., *.py, tests" />
        <small>Add multiple patterns separated by commas</small>
      </div>

      <!-- Include Pattern -->
      <label for="includePattern">Include pattern(s) (optional):</label>
      <div class="input-wrapper">
        <input type="text" id="includePattern" placeholder="e.g., src/*.jsx, foo.*" />
        <small>Add multiple patterns separated by commas</small>
      </div>

      <!-- Start Scan -->
      <div id="scanStatus" class="scan-status">
        ‚è≥ Scanning in progress...
      </div>
      
      <button type="button" id="startSemgrepScan">Start Scan</button>
    </div>  


    <!-- Matches list with pagination -->
    <h2>Matched Patterns:</h2>
    {{paginationTop}}

    <div id="matches">
      {{matches}}
    </div>

    {{paginationBottom}}

    <button type="button" id="importMatches">Import Matches</button>
  </div>

  
  <!-- Scripts -->
  <script src="{{testSectionJsUri}}"></script>
</body>
</html>